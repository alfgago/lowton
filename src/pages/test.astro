<div class="flex w-full">
	<div class="spacer w-1/2" style="height:50vh;">Scroll Down</div>
	<div class="wrapper w-1/2">
		<div class="header">GSAP SCROLLTRIGGER<br /> <span>FREE DEMO</span></div>
		<div class="cards">
			<div class="card">stacking</div>
			<div class="card">cards</div>
			<div class="card">for</div>
			<div class="card">you</div>
			<div class="card">to</div>
			<div class="card">explore</div>
			<div class="card">and</div>
			<div class="card">use</div>
		</div>
	</div>
</div>
<div class="spacer" style="height:100vh; text-align:center;">
	SEE VIDEO DESCRIPTION FOR DEMO LINK
</div>

<div class="brand" style="background:black; text-align:center;">
	<a
		href="https://www.creativecodingclub.com/bundles/creative-coding-club?src=cdp3droll"
		target="_blank"
		><img
			src="https://assets.codepen.io/32887/logo-ill.svg"
			width="300"
			alt=""
		/></a
	>
</div>

<style>
	@import url("https://fonts.googleapis.com/css?family=Teko");

	* {
		position: relative;
		box-sizing: border-box;
	}

	.cards {
		width: 100%;
		height: 50vh;
		position: relative;
	}

	.card {
		padding: 2em;
		color: white;
		position: absolute;
		width: 100%;
		height: 100%;
		background: #1565c0;
		text-transform: uppercase;
		font-size: 10vw;
	}

	body {
		margin: 0;
		font-family: "Teko", sans-serif;
		background: #bbdefb;
	}

	.card,
	.header,
	.spacer {
		display: flex;
		align-items: center;
		justify-content: center;
		flex-direction: column;
		font-size: 50px;
		text-shadow: 2px 2px 4px rgb(0, 0, 0, 0.3);
	}

	.header {
		width: 100%;
		height: 150px;
		background: #060606;
		color: yellow;
	}

	.card:nth-child(odd) {
		background: #303f9f;
	}

	.spacer {
		font-size: 50px;
		margin: 20px;
	}
</style>

<script>
	import { gsap } from "gsap";
	import { ScrollTrigger } from "gsap/ScrollTrigger";
	gsap.registerPlugin(ScrollTrigger);

	const cards = document.querySelectorAll(".card");
	const header = document.querySelector(".header");
	const animation = gsap.timeline();
	let cardHeight: number;

	function initCards() {
		animation.clear();
		cardHeight = (cards[0] as HTMLElement).offsetHeight;
		console.log("initCards()", cardHeight);
		cards.forEach((card, index) => {
			if (index > 0) {
				//increment y value of each card by cardHeight
				gsap.set(card, { y: index * cardHeight });
				//animate each card back to 0 (for stacking)
				animation.to(card, { y: 0, duration: index * 0.5, ease: "none" }, 0);
			}
		});
	}

	initCards();

	ScrollTrigger.create({
		trigger: ".wrapper",
		start: "top top",
		pin: true,
		end: () =>
			`+=${cards.length * cardHeight + (header as HTMLElement)?.offsetHeight}`,
		scrub: true,
		animation: animation,
		markers: true,
		invalidateOnRefresh: true,
	});

	ScrollTrigger.addEventListener("refreshInit", initCards);

	// Become a GSAP and ScrollTrigger Pro
	// visit https://www.creativecodingclub.com/
	// Unlock over 200 lessons and get new lessons weekly

	//automate scroll
	/* gsap.delayedCall(1, ()=>{
  gsap.to(window, {scrollTo:{y:"max", autoKill:true}, duration:15, repeat:1, yoyo:true, repeatDelay:1, ease:"none"})
  
})
 */
</script>
